{% extends "curso1/index.html" %}
{% block level1 %}
<script>
  $('.add-book').click(function(ev){
    ev.preventDefault();
    var count = $('.books').children().length;
    var tmplMarkup = $('#book-template').html();
    var compiledTmpl = _.template(tmplMarkup, { id : count });
    $('div.books').append(compiledTmpl);
    // update form count
    $('#id_books-TOTAL_FORMS').attr('value', count+1);
  });
</script>

<h1>Add an Author and Books</h1>
<form action="" method="POST">
{% csrf_token %}
<ul>
{{ form.as_ul }}
</ul>
<input id="save_contact" type="submit" value="Save" />

<script type="text/html" id="book-template">
  <div id="book-<%= id %>">
    <label for="id_books-<%= id %>-title">Book Title:</label>
    <input id="id_books-<%= id %>-title" type="text" name="books-<%= id %>-title" maxlength="100">
    <input type="hidden" name="books-<%= id %>-author" id="id_books-<%= id %>-author">
    <input type="hidden" name="books-<%= id %>-id" id="id_books-<%= id %>-id">
  </div>
</script>

{% endblock %}